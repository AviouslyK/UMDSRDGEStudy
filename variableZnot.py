import numpy

#program to calculate Znot for each wavelength

#Waves   = [350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 405, 410, 415, 
#           420, 425, 430, 435, 440, 445, 450, 455, 460, 465, 470, 475, 480, 485, 
#           490, 495, 500]

Waves    = [380, 385, 390, 395, 400, 405, 410, 415, 420, 425, 430, 435, 440, 445] 
#Waves    = [350, 355, 360, 365, 370, 375, 380, 385, 390, 393, 395, 396, 397, 398, 
#            399, 400, 401, 402, 403, 404, 405, 406, 407, 410, 415, 420, 425, 430, 
#            435, 440, 445, 450, 455, 460, 465, 470, 475, 480, 485, 490, 495, 500, 
#            505, 510, 515, 520, 525, 530]             


#Mu1s from Set V3
a        = [1.746, 1.594, 1.22, 0.718, 0.315, 0.108, 0.04, 0.024, 0.018, 0.015, 
           0.013, 0.011, 0.01, 0.009, 0.008] 



################################ Set V1 ######################################

#6mm and 10mm MuEffective values for each wavelength
#MuE3
b        = [1.1610785, 1.0720943, 0.8165934, 0.4803388, 0.2118853, 0.0738176, 
            0.0287586, 0.0177433, 0.014333, 0.0122392, 0.0109456, 0.0098272, 
            0.0090199, 0.0082186] 
#MuE1
c        = [0.7128232, 0.7102459, 0.6817807, 0.4620325, 0.2040897, 0.068311, 
            0.0239382, 0.0131662, 0.0098934, 0.0080284, 0.0067998, 0.0059499, 
            0.0052333, 0.0046555] 

##############################################################################


#4 mm mueffective values for each  wavelength
#MuE4
#a   = [1.78837, 1.76991, 1.77515, 1.77419, 1.77252, 1.77515, 1.74603,
#           1.59420, 1.21951, 0.91852, 0.71836, 0.62381, 0.53662, 0.45450, 
#           0.38012, 0.31500, 0.25916, 0.20958, 0.16910, 0.13522, 0.10846, 
#           0.08669, 0.07012, 0.04044, 0.02381, 0.01850, 0.01500, 0.01274, 
#           0.01121, 0.01004, 0.00885, 0.00789, 0.00722, 0.00637, 0.00562, 
#           0.00515, 0.00482, 0.00442, 0.00383, 0.00361, 0.00326, 0.00282, 
#           0.00268, 0.00239, 0.00216, 0.00200, 0.00186, 0.00162]

# 6 mm

#MuE3s
#b       = [1.19009, 1.17853, 1.19590, 1.18628, 1.19094, 1.19174, 1.19163, 
#           1.15872, 0.98492, 0.76041, 0.60098, 0.52316, 0.44934, 0.38198,
#           0.32017, 0.26492, 0.21749, 0.17736, 0.14317, 0.11497, 0.09243,
#           0.07445, 0.06037, 0.03532, 0.02104, 0.01612, 0.01309, 0.01093,
#           0.00947, 0.00830, 0.00723, 0.00629, 0.00556, 0.00484, 0.00409, 
#           0.00365, 0.00335, 0.00289, 0.00245, 0.00214, 0.00175, 0.00142,
#           0.00123, 0.00095, 0.00070, 0.00056, 0.00036, 0.00016]

# 10 mm

#MuE1s
#c       = [0.72051, 0.71382, 0.71334, 0.71556, 0.71628, 0.71916, 0.71628, 
#           0.71502, 0.69708, 0.61230, 0.49971, 0.43698, 0.37726, 0.32051, 
#           0.26911, 0.22290, 0.18299, 0.14840, 0.11959, 0.09562, 0.07652, 
#           0.06130, 0.04950, 0.02832, 0.01619, 0.01221, 0.00986, 0.00828, 
#           0.00713, 0.00625, 0.00549, 0.00480, 0.00419, 0.00353, 0.00309, 
#           0.00272, 0.00247, 0.00215, 0.00185, 0.00165, 0.00144, 0.00126, 
#           0.00112, 0.00099, 0.00087, 0.00077, 0.00066, 0.00054]


#from simulation (not equations)
#0.69643, 0.69791, 0.69643, 0.69272, 0.69768, 0.70000, 0.70000,
#           0.70000, 0.69930, 0.69272, 0.66102, 0.60937, 0.54379, 0.46941,
#           0.39484, 0.32608, 0.26449, 0.21056, 0.16525, 0.12785, 0.09814,
#           0.07427, 0.05607, 0.02389, 0.00765, 0.00399, 0.00265, 0.00202,
#           0.00169, 0.00161, 0.00161, 0.00173, 0.00176, 0.00172, 0.00171,
#           0.00176, 0.00172, 0.00159, 0.00142, 0.00129, 0.00115, 0.00098,
#           0.00092, 0.00082, 0.00075, 0.00072, 0.00071, 0.00070

t1 = 10;
t2 = 8;
t3 = 6;
t4 = 4;
     
Znots   = [None]*15;
#Mu1s    = [None]*48;
Mu2s    = [None]*15;

#assume Znot is constant 
#Znot = 2.6795
#for i in range(len(Waves)):
            
#            Mu1 = MuE4s[i];
#            Mu1s[i] = Mu1;

#            Mu2 = (MuE3s[i]+(2*Znot*Mu1s[i]/t3))/(1+(2*Znot/t3));
#            Mu2s[i] = Mu2;


for i in range(len(Waves)):
                
    #        a = MuE4s[i];
     #       Mu1s[i] = Mu1;

            #Mu2 = (-MuE3s[i]*t3+MuE1s[i]*t1)/(t1-t3);
    Mu2      = (t3*b[i]-t1*c[i])/(t3-t1);        
    Mu2s[i]  = Mu2;

            #Znot = (t1*t3*(-MuE1s[i]+MuE3s[i]))/(2*(Mu1s[i]*(t1-t3)+MuE3s[i]*t3-MuE1s[i]*t1)); 
    Znot     = (t3*t1*(b[i]-c[i]))/(2*(t3*b[i]-t1*c[i]+a[i]*(t1-t3)));
    #print '%s'% Znot;
    Znots[i] = Znot;

    #############old equations##############
  #  Mu1 = a[i];
  #  Mu1s[i] = Mu1;

   # Mu2 = (b[i]*t3 - a[i]*t1)/(t3-t1);
   # Mu2s[i] = Mu2;

   # Znot = 0.5*t3*(b[i]-Mu2)/(c[i]-Mu2);
   # Znots[i] = Znot;




#ZnotAvg = sum(Znots)/len(Znots);
#Mu1Avg  = sum(Mu1s)/len(Mu1s);
#Mu2Avg  = sum(Mu2s)/len(Mu2s);

#print parameter values
#print 'Wavelength \t\tMu1 \t\tMu2' 
#for w,m1,m2 in zip(Waves,Mu1s,Mu2s):
#    print "%.3f \t\t%.3f \t\t%.3f" % (w, m1, m2)
#print Znot values
print 'Wavelength \t\tZnot \t\tMu1 \t\tMu2' 
for w,z,m1,m2 in zip(Waves,Znots,a,Mu2s):
    print "%.3f \t\t%.3f \t\t%.3f \t\t%.3f" % (w, z, m1, m2)

